import{r as l,j as t,c as y}from"./script-n-modules.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();const j="";function p(e){if(!e.ok)throw new Error("Серверная ошибка: данные недоступны")}const g=async e=>{try{const o=await fetch(`${j}${e}`);p(o);const s=await(o==null?void 0:o.text());return s?JSON.parse(s):null}catch(o){return console.error(o),null}};function $(e){return t.jsx("button",{onClick:()=>{e.sendVote(e.id)},children:e.name})}const N=l.memo($),P="";function b(e){if(!e.ok)throw new Error("Серверная ошибка: данные недоступны")}const m=async(e,o={})=>{try{const s=await fetch(`${P}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});b(s);const i=await(s==null?void 0:s.text());return i?JSON.parse(i):null}catch(s){return console.error(s),null}};let I=(e,o="голос",s="голоса",i="голосов")=>{const n=e%100;if(n>=11&&n<=19)return i;const r=e%10;return r===1?o:r>=2&&r<=4?s:i};function w(e){return t.jsxs("tr",{children:[t.jsx("td",{children:`${e.id}`}),t.jsx("td",{children:`${e.name}`}),t.jsx("td",{children:`${e.votes} ${I(e.votes)}`})]})}const A=l.memo(w);function E(){const[e,o]=l.useState([]),[s,i]=l.useState([]),n=c=>{g(c).then(d=>o(d))},r=(c,d)=>{m(c,d).then(h=>i(h))},a=c=>{m("/vote",{idVote:c}).then(()=>r("/stat"))};l.useEffect(()=>(n("/variants"),r("/stat"),()=>{}),[]);const x=c=>{var d;return(d=e==null?void 0:e.find(h=>h.id===c))==null?void 0:d.name},u=e==null?void 0:e.map(c=>t.jsx(N,{id:c.id,name:c.name,sendVote:a},c.id+10)),f=s==null?void 0:s.map(c=>{let d=x(c.id);return t.jsx(A,{id:c.id,votes:c.votes,name:d},c.id+100)});return t.jsxs("div",{className:"container",children:[t.jsx("h2",{children:"Голосование"}),t.jsxs("div",{className:"info-box",style:{display:(e==null?void 0:e.length)>0&&(f==null?void 0:f.length)>0?"block":"none"},children:[t.jsx("h3",{children:"Статистика:"}),t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"ID"}),t.jsx("th",{children:"Позиция"}),t.jsx("th",{children:"Количество голосов"})]})}),t.jsx("tbody",{children:f})]})]}),t.jsxs("div",{className:"btn-group",style:{display:(u==null?void 0:u.length)>0?"block":"none"},children:[t.jsx("h3",{children:"Проголосовать:"}),u]})]})}y.createRoot(document.getElementById("root")).render(t.jsx(E,{}));
