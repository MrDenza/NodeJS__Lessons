import{j as t,r as x,c as I}from"./script-n-modules.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function i(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=i(r);fetch(r.href,o)}})();const J={GET:{classN:"favorite-pos_get"},POST:{classN:"favorite-pos_post"},PUT:{classN:"favorite-pos_put"},PATCH:{classN:"favorite-pos_patch"},DELETE:{classN:"favorite-pos_delete"},HEAD:{classN:"favorite-pos_head"},OPTIONS:{classN:"favorite-pos_options"}};function z(e){var n;return((n=J[e])==null?void 0:n.classN)||""}function K(e){var i;const n=(i=e.method)==null?void 0:i.toUpperCase();return t.jsxs("div",{className:`favorite-pos ${z(n)}`,onClick:()=>{e.openPosition(e.idPos)},children:[t.jsxs("span",{className:"favorite-pos_text-bold",children:["Метод: ",n]}),t.jsx("span",{className:"favorite-pos_ellipsis",children:e.url})]})}function G(e){const n=Array.isArray(e.dataList)?e.dataList:[],i=n==null?void 0:n.map((s,r)=>t.jsx(K,{idPos:r,method:s.method,url:s.url,openPosition:e.openPosition},r));return t.jsxs("div",{className:"favorite-box",children:[t.jsx("span",{className:"favorite-box__title",children:"Избранное:"}),e.isLoading?t.jsxs("div",{className:"animation__dot-pulse",children:[t.jsx("span",{}),t.jsx("span",{}),t.jsx("span",{})]}):t.jsx("div",{className:"favorite-box__list",children:i})]})}const W=x.memo(G);function Y(e){var n,i;return t.jsxs("tr",{className:"row-data__box",children:[t.jsx("td",{children:t.jsx("label",{children:e.isOptions?t.jsxs("select",{value:(n=e.options)!=null&&n.includes(e.name)?e.name:"",onChange:s=>e.onChange(e.id,"name",s.target.value,e.isOptions),children:[t.jsx("option",{value:"",disabled:!0,children:"Выберите заголовок:"},"200"),(i=e.options)==null?void 0:i.map(s=>t.jsx("option",{value:s,disabled:e.usedOptions.includes(s)&&s!==e.name,children:s},s))]}):t.jsx("input",{type:"text",value:e.name||"",onChange:s=>e.onChange(e.id,"name",s.target.value)})})}),t.jsx("td",{children:t.jsx("label",{children:t.jsx("input",{type:"text",value:e.value||"",onChange:s=>e.onChange(e.id,"value",s.target.value,e.isOptions)})})}),t.jsx("td",{children:t.jsx("button",{onClick:s=>e.onDelete(s,e.id,e.isOptions),children:"Удалить"})})]})}const B=x.memo(Y);function Q(e){var i;const n=(e.data||[]).map((s,r)=>{const o=Object.keys(s),h=o.length>0?o[0]:"";return t.jsx(B,{id:r,name:h||"",value:s[h],onChange:e.onChange,onDelete:e.onDelete},r)});return t.jsxs("div",{className:"get-body__box",children:[t.jsx("span",{className:"get-body__title",children:"Параметры"}),t.jsxs("table",{children:[((i=e.data)==null?void 0:i.length)>0&&t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Ключ"}),t.jsx("th",{children:"Значение"}),t.jsx("th",{})]})}),t.jsx("tbody",{children:n})]}),t.jsx("button",{onClick:s=>{e.onAdd(s)},children:"Добавить параметр"})]})}const X=x.memo(Q);function Z(e){return t.jsxs("div",{className:"post-body__box",children:[t.jsx("span",{className:"post-body__title",children:"Тело запроса:"}),t.jsx("textarea",{className:"post-body__textarea",value:e.body,onChange:n=>e.onChange(n.target.value)})]})}const ee=x.memo(Z),D=!0;function te(e){var i;const n=(e.data||[]).map((s,r)=>{const o=Object.keys(s),h=o.length>0?o[0]:"",_=e.data.map(g=>Object.keys(g)[0]).filter(g=>g!==h);return t.jsx(B,{id:r,name:h,value:s[h],isOptions:D,options:e.headers,usedOptions:_,onChange:e.onChange,onDelete:e.onDelete},r)});return t.jsxs("div",{className:"head-body__box",children:[t.jsx("span",{className:"head-body__title",children:"Заголовки"}),t.jsxs("table",{children:[((i=e.data)==null?void 0:i.length)>0&&t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Заголовок"}),t.jsx("th",{children:"Значение"}),t.jsx("th",{})]})}),t.jsx("tbody",{children:n})]}),t.jsx("button",{onClick:s=>e.onAdd(s,D),children:"Добавить заголовок"})]})}const q=["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"],P=["GET","DELETE","HEAD","OPTIONS"],k=["POST","PUT","PATCH"],H=["Accept","Accept-Charset","Accept-Encoding","Accept-Language","Authorization","Cookie","Content-Disposition","Content-Encoding","Content-Language","Content-Length","Content-MD5","Content-Range","Content-Type","Content-Version","Derived-From","Expect","Form","Host","Link","Max-Forwards","Proxy-Authorization","Range","Referer","Title","TE"],F={method:"",url:"",query:[],body:"",headers:[]},y={method:{nullField:"Выберите метод запроса!",noValidMethod:"Выбранный метод не доступен!"},url:{nullField:"Введите URL запроса!",noValidUrl:"Некорректный формат URL!",noParamsAllowed:"URL не должен содержать параметры запроса"},query:{errTypeValue:'Ошибка значений параметров! Удалите все пары "ключ-значение" и пересоздайте снова.',nullField:'Есть незаполненные поля! Заполните или удалите незаполненные пары "ключ-значение".',duplicateKey:'Нельзя использовать несколько пар "ключ-значение" с одинаковыми ключами!'},body:{noContentType:"Content-Type не указан в заголовках!",invalidType:"Неподдерживаемый Content-Type!",noValidBody:"Тело запроса не соответствует Content-Type!",noCorrectBody:"Некорректный формат тела!"},headers:{errTypeValue:'Ошибка значений заголовков! Удалите все пары "заголовок-значение" и пересоздайте снова.',nullField:'Есть незаполненные поля! Заполните или удалите незаполненные пары "заголовок-значение".',noValidHeader:"Есть некорректные заголовки! Выберите заголовки из доступного списка.",duplicateKey:'Нельзя использовать несколько пар "заголовок-значение" с одинаковыми заголовками!'}},U={method:e=>e?q.includes(e.toUpperCase())?!1:y.method.noValidMethod:y.method.nullField,url:e=>{if(!e)return y.url.nullField;if(URL.canParse)return URL.canParse(e)?!1:y.url.noValidUrl;try{new URL(e)}catch{return y.url.noValidUrl}return!1},query:e=>{if(!(Array.isArray(e)&&e.every(o=>typeof o=="object"&&Object.keys(o).length===1)))return y.query.errTypeValue;const i=e.map(o=>Object.keys(o)[0]);return i.length!==new Set(i).size?y.query.duplicateKey:e.some(o=>Object.entries(o).some(([h,_])=>!h.trim()||!_.toString().trim()))?y.query.nullField:!1},body:(e,n)=>{if(!n)return y.body.noContentType;if(e==null)return y.body.noValidBody;try{if(n.includes("application/json")){const i=typeof e=="string"?JSON.parse(e):e;if(typeof i!="object"||i===null)return y.body.noCorrectBody}else if(n.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams(e);if(Array.from(i.entries()).length===0&&e.trim()!=="")return y.body.noValidBody}else if(n.includes("text/plain")){if(typeof e!="string")return y.body.noValidBody}else return y.body.invalidType;return!1}catch{return y.body.noValidBody}},headers:e=>{if(!(Array.isArray(e)&&e.every(r=>typeof r=="object"&&Object.keys(r).length===1)))return y.headers.errTypeValue;const i=e.map(r=>Object.keys(r)[0]);if(i.length!==new Set(i).size)return y.headers.duplicateKey;for(const r of e){const[[o,h]]=Object.entries(r);if(!o.trim())return y.headers.nullField;if(!H.includes(o))return y.headers.noValidHeader;if(!h.toString().trim())return y.headers.nullField}return!1}};function se(e){return!e||typeof e!="object"||Array.isArray(e)||Object.keys(e).length===0}function ne(e){var m;const[n,i]=x.useState(F),[s,r]=x.useState({}),o=((m=n.method)==null?void 0:m.toUpperCase())||"";x.useEffect(()=>{se(e.dataReq)||(i(e.dataReq),r({}))},[e.dataReq]);const h=l=>{let c={},u=null;if(Array.isArray(l.headers)){const b=l.headers.find(a=>Object.keys(a).some(v=>v.toLowerCase()==="content-type"));if(b){const a=Object.keys(b).find(v=>v.toLowerCase()==="content-type");u=b[a]}}const d=typeof l.method=="string"?l.method.toUpperCase():"";for(let b in l)if(b==="body"){if(k.includes(d)){let a=U.body(l[b],u);a&&(c[b]=a)}}else{let a=U[b](l[b]);a&&(c[b]=a)}return r(c),!Object.keys(c).length},_=l=>{if(l.preventDefault(),e.resetDataRes(!0),h(n))return e.sendDataReq(n)},g=l=>{l.preventDefault(),i(F),r({}),e.resetDataRes(!0)},w=()=>{if(h(n))return e.saveDataReq(n)},O=l=>{const c=typeof l.target.value=="string"?l.target.value.toUpperCase():"";i(u=>{let d={...u};return d.method=c,P.includes(c)?"body"in d&&(d.body=""):"query"in d&&(d.query=[]),d}),e.resetDataRes(!0),r({})},N=l=>{const c=typeof l.target.value=="string"?l.target.value.trim():"";i(u=>u.url===c?u:{...u,url:c})},R=(l,c,u,d)=>{const b=d?"headers":"query",a=typeof u=="string"?u.trim():"";i(v=>{const L=JSON.parse(JSON.stringify(v[b])),p=JSON.parse(JSON.stringify(L[l])),S=Object.keys(p)[0];if(c==="name"){if(S===a)return v;const M=p[S];delete p[S],p[a]=M}else if(c==="value"){if(p[S]===a)return v;p[S]=a}return L[l]=p,{...v,[b]:L}})},C=(l,c,u)=>{l.preventDefault();const d=u?"headers":"query";console.log(`Удалён элемент из ${d} с id: ${c+1}`),i(b=>{const a=JSON.parse(JSON.stringify(b));return a[d]=a[d].filter((v,L)=>L!==c),a})},j=(l,c)=>{l.preventDefault();const u=c?"headers":"query";i(d=>({...d,[u]:[...Array.isArray(d[u])?d[u]:[],{"":""}]}))},f=l=>{const c=typeof l=="string"?l.trim():"";i(u=>u.body===c?u:{...u,body:c})},E=q.map((l,c)=>t.jsx("option",{value:l,children:l},c));return t.jsxs("form",{id:"formReq",onSubmit:_,onReset:g,className:"control-box__form",children:[t.jsxs("table",{className:"control-box__table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"control-box__table-method",children:t.jsx("label",{htmlFor:"method",children:"Метод"})}),t.jsx("th",{className:"control-box__table-url",children:t.jsx("label",{htmlFor:"url",children:"URL"})})]})}),t.jsx("tbody",{children:t.jsxs("tr",{children:[t.jsx("td",{children:t.jsxs("select",{id:"method",className:"table-method__input",value:o,onChange:O,children:[t.jsx("option",{value:"",disabled:!0,children:"Выберите метод:"},"100"),E]})}),t.jsx("td",{children:t.jsx("input",{type:"text",id:"url",className:"table-url__input",value:(n==null?void 0:n.url)||"",onChange:N})})]})})]}),t.jsx("div",{className:"control-box_text-err",children:s==null?void 0:s.method}),t.jsx("div",{className:"control-box_text-err",children:s==null?void 0:s.url}),t.jsx("hr",{}),P.includes(o)&&t.jsxs(x.Fragment,{children:[t.jsx(X,{data:n==null?void 0:n.query,onChange:R,onDelete:C,onAdd:j}),t.jsx("div",{className:"control-box_text-err",children:s==null?void 0:s.query})]}),k.includes(o)&&t.jsxs(x.Fragment,{children:[t.jsx(ee,{body:n==null?void 0:n.body,onChange:f}),t.jsx("div",{className:"control-box_text-err",children:s==null?void 0:s.body})]}),o&&t.jsx("hr",{}),o&&t.jsxs(x.Fragment,{children:[t.jsx(te,{data:n==null?void 0:n.headers,headers:H,onChange:R,onDelete:C,onAdd:j}),t.jsx("div",{className:"control-box_text-err",children:s==null?void 0:s.headers})]}),o&&t.jsx("hr",{}),t.jsxs("div",{className:"control-box__btn",children:[t.jsx("button",{type:"button",onClick:w,children:"Сохранить запрос"}),t.jsx("button",{type:"submit",children:"Отправить запрос"}),t.jsx("button",{type:"reset",children:"Сбросить форму"})]})]})}const ie=x.memo(ne);function re(e,n){const i=document.createElement("a");i.href=e,i.download=n,i.click(),URL.revokeObjectURL(i.href)}function oe(e){var h,_,g,w,O,N,R,C;const[n,i]=x.useState(!1);if(console.log(e.dataRes.body),e.isLoading)return t.jsxs("div",{className:"view-box__body",children:[t.jsx("h3",{className:"view-box__title",children:"Ответ на запрос"}),t.jsxs("div",{className:"animation__dot-pulse",children:[t.jsx("span",{}),t.jsx("span",{}),t.jsx("span",{})]})]});if(!e.dataRes||Object.keys(e.dataRes).length===0)return null;const s=()=>{const j=e.dataRes.headers["content-type"]||"";if(j.startsWith("application/json"))try{return t.jsx("pre",{className:"view-box__preview-json",children:JSON.stringify(e.dataRes.body,null,2)})}catch{return null}if(j.startsWith("text/html"))return t.jsx("iframe",{srcDoc:e.dataRes.body,title:"HTML Preview",sandbox:"allow-scripts",className:"view-box__preview-iframe"});if(j.startsWith("text/plain"))return t.jsx("pre",{className:"view-box__preview-text",children:e.dataRes.body});if(e.dataRes.body.match(/^[A-Za-z0-9+/=]+$/)){const f=j.split(";")[0];return t.jsxs("div",{className:"view-box__preview-binary",children:[t.jsxs("span",{className:"view-box__preview-bin-text",children:["Бинарные данные (",f,")"]}),f.startsWith("image/")?t.jsx("img",{src:`data:${f};base64,${e.dataRes.body}`,alt:"Preview",className:"view-box__preview-img"}):f.startsWith("audio/")?t.jsx("audio",{controls:!0,className:"view-box__preview-audio",children:t.jsx("source",{src:`data:${f};base64,${e.dataRes.body}`})}):f.startsWith("video/")?t.jsx("video",{controls:!0,className:"view-box__preview-video",children:t.jsx("source",{src:`data:${f};base64,${e.dataRes.body}`})}):t.jsxs("div",{className:"view-box__preview-other",children:[t.jsxs("div",{className:"view-box__preview-box-btn",children:[t.jsx("button",{onClick:()=>i(!n),className:"view-box__preview-btn",children:n?"Скрыть base64":"Показать base64"}),t.jsx("button",{onClick:()=>re(`data:${f};base64,${e.dataRes.body}`,"file.bin"),className:"view-box__preview-btn",children:"Скачать файл"})]}),n&&t.jsx("textarea",{readOnly:!0,value:e.dataRes.body,className:"view-box__preview-textarea"})]})]})}return null},r=(h=e.dataRes.redirects)==null?void 0:h.map((j,f)=>t.jsxs("div",{className:"view-box__redirect-pos",children:[t.jsx("span",{children:t.jsxs("b",{children:["Redirect №",f+1,":"]})}),t.jsxs("span",{children:[t.jsx("b",{children:"URL запроса:"})," ",j.startUrl]}),t.jsxs("span",{children:[t.jsx("b",{children:"Статус ответа:"})," ",j.status]}),t.jsxs("span",{children:[t.jsx("b",{children:"Location:"})," ",j.location]}),t.jsx("hr",{})]},f)),o=Object.keys((_=e.dataRes)==null?void 0:_.headers).map((j,f)=>t.jsxs("li",{children:[t.jsx("b",{children:j}),": ",e.dataRes.headers[j]]},f));return t.jsxs("div",{className:"view-box__body",children:[t.jsx("h3",{className:"view-box__title",children:"Ответ на запрос"}),((g=e.dataRes.redirects)==null?void 0:g.length)>0&&t.jsx("div",{className:"view-box__redirect-container",children:r}),t.jsxs("div",{className:"view-box__res-container",children:[t.jsxs("span",{children:[t.jsx("b",{children:"URL запроса:"})," ",(w=e.dataRes)==null?void 0:w.finalUrl]}),t.jsxs("span",{children:[t.jsx("b",{children:"Статус ответа:"})," ",(O=e.dataRes)==null?void 0:O.status]}),t.jsx("span",{children:t.jsx("b",{children:"Заголовки ответа:"})}),t.jsx("ul",{className:"view-box__list",children:o}),t.jsx("span",{children:t.jsx("b",{children:"Тело ответа:"})}),t.jsx("div",{className:"view-box__res-body",children:typeof((N=e.dataRes)==null?void 0:N.body)=="string"?(R=e.dataRes)==null?void 0:R.body:JSON.stringify((C=e.dataRes)==null?void 0:C.body)}),t.jsx("span",{children:t.jsx("b",{children:"Превью ответа:"})}),t.jsx("div",{className:"view-box__res-preview",children:s()})]})]})}const ae=x.memo(oe);function le(e){return t.jsxs("div",{className:"control-box",children:[t.jsx(ie,{dataReq:e.dataReq,sendDataReq:e.sendDataReq,saveDataReq:e.saveDataReq,resetDataRes:e.resetDataRes}),t.jsx(ae,{dataRes:e.dataRes,isLoading:e.isLoading})]})}const ce=x.memo(le),de="";function ue(e){if(!e.ok)throw new Error(`${e.status} ${e.statusText}`)}const V=async(e,n={},i="")=>{try{const s=await fetch(`${de}${e}`,{method:"POST",headers:{Accept:i,"Content-Type":i||"application/json"},body:JSON.stringify(n)});ue(s);const r=s.headers.get("Content-Type")||"";return r.includes("application/json")?await s.json():r.startsWith("text/")?await s.text():r.includes("application/octet-stream")||r.includes("application/pdf")||r.includes("image/")||r.includes("audio/")||r.includes("video/")?await s.blob():await s.text()}catch(s){return alert(s),console.error(s),s}},T={getDataList:"/datalist",sendDataReq:"/send"};function $(e){var i;const n=s=>(s==null?void 0:s.map(r=>{const o=Object.entries(r);return o.sort(([h],[_])=>h.localeCompare(_)),JSON.stringify(o)}).sort().join("|"))||"";return{method:e.method.toLowerCase(),url:e.url.toLowerCase().trim(),body:((i=e.body)==null?void 0:i.trim())||"",query:n(e.query),headers:n(e.headers)}}function he(e,n){const i=$(e);return n.some(s=>{const r=$(s);return r.method===i.method&&r.url===i.url&&r.body===i.body&&r.query===i.query&&r.headers===i.headers})}function A(e){alert(e),console.error(e)}function xe(){const[e,n]=x.useState([]),[i,s]=x.useState({}),[r,o]=x.useState({}),[h,_]=x.useState(!1),[g,w]=x.useState(!1),O=(m,l,c)=>{const u=window.localStorage.getItem("id"),d=u?{id:u}:{},b=c?{...d,add:c}:d;V(m,b).then(a=>{try{a!=null&&a.id&&window.localStorage.setItem("id",String(a==null?void 0:a.id)),a!=null&&a.error&&A(`Ошибка: ${a==null?void 0:a.error}`),Array.isArray(a==null?void 0:a.list)&&(a==null?void 0:a.list.length)>0&&l(a==null?void 0:a.list),_(!1)}catch(v){A(`Ошибка загрузки раздела "Избранное": ${v}`)}}).catch(a=>{A(`Ошибка загрузки раздела "Избранное": ${a}`)})},N=x.useCallback((m,l)=>{O(m,u=>{n(u)},l)},[]),R=(m,l,c)=>{V(m,c?{send:c}:{}).then(d=>{d!=null&&d.dataRes&&l(d.dataRes),w(!1)}).catch(d=>{A(`Ошибка запроса: ${d}`)})};x.useEffect(()=>(_(!0),N(T.getDataList,void 0),()=>{}),[N]);const C=m=>{let l=c=>{o(c)};R(T.sendDataReq,l,m),w(!0),s({...m})},j=m=>{m&&(o({}),s({}))},f=m=>{if(he(m,e))return alert("Такой запрос уже есть в избранном!");N(T.getDataList,m)},E=m=>{o({}),s(e[m])};return t.jsxs("div",{className:"container",children:[t.jsx(W,{dataList:e,openPosition:E,isLoading:h}),t.jsx(ce,{dataReq:i,dataRes:r,sendDataReq:C,saveDataReq:f,resetDataRes:j,isLoading:g})]})}I.createRoot(document.getElementById("root")).render(t.jsx(xe,{}));
