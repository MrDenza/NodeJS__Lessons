import{r as y,j as t,c as M}from"./script-n-modules.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const x of o.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&s(x)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();function J(e){return y.useEffect(()=>{const i=document.querySelector(".favorite-box__list");if(!i)return;const r=s=>{const n=s.target.closest(".favorite-pos");if(!n)return;const o=n.getAttribute("data-idpos");o!==null&&e.openPosition(o)};return i.addEventListener("click",r),()=>i.removeEventListener("click",r)},[e,e.dataListHtml]),t.jsxs("div",{className:"favorite-box",children:[t.jsx("span",{className:"favorite-box__title",children:"Избранное:"}),e.isLoading?t.jsxs("div",{className:"animation__dot-pulse",children:[t.jsx("span",{}),t.jsx("span",{}),t.jsx("span",{})]}):t.jsx("div",{style:{height:"100%"},dangerouslySetInnerHTML:{__html:e.dataListHtml}})]})}const z=y.memo(J);function K(e){var i,r;return t.jsxs("tr",{className:"row-data__box",children:[t.jsx("td",{children:t.jsx("label",{children:e.isOptions?t.jsxs("select",{value:(i=e.options)!=null&&i.includes(e.name)?e.name:"",onChange:s=>e.onChange(e.id,"name",s.target.value,e.isOptions),children:[t.jsx("option",{value:"",disabled:!0,children:"Выберите заголовок:"},"200"),(r=e.options)==null?void 0:r.map(s=>t.jsx("option",{value:s,disabled:e.usedOptions.includes(s)&&s!==e.name,children:s},s))]}):t.jsx("input",{type:"text",value:e.name||"",onChange:s=>e.onChange(e.id,"name",s.target.value)})})}),t.jsx("td",{children:t.jsx("label",{children:t.jsx("input",{type:"text",value:e.value||"",onChange:s=>e.onChange(e.id,"value",s.target.value,e.isOptions)})})}),t.jsx("td",{children:t.jsx("button",{onClick:s=>e.onDelete(s,e.id,e.isOptions),children:"Удалить"})})]})}const $=y.memo(K);function W(e){var r;const i=(e.data||[]).map((s,n)=>{const o=Object.keys(s),x=o.length>0?o[0]:"";return t.jsx($,{id:n,name:x||"",value:s[x],onChange:e.onChange,onDelete:e.onDelete},n)});return t.jsxs("div",{className:"get-body__box",children:[t.jsx("span",{className:"get-body__title",children:"Параметры"}),t.jsxs("table",{children:[((r=e.data)==null?void 0:r.length)>0&&t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Ключ"}),t.jsx("th",{children:"Значение"}),t.jsx("th",{})]})}),t.jsx("tbody",{children:i})]}),t.jsx("button",{onClick:s=>{e.onAdd(s)},children:"Добавить параметр"})]})}const G=y.memo(W);function Y(e){return t.jsxs("div",{className:"post-body__box",children:[t.jsx("span",{className:"post-body__title",children:"Тело запроса:"}),t.jsx("textarea",{className:"post-body__textarea",value:e.body,onChange:i=>e.onChange(i.target.value)})]})}const Q=y.memo(Y),D=!0;function X(e){var r;const i=(e.data||[]).map((s,n)=>{const o=Object.keys(s),x=o.length>0?o[0]:"",g=e.data.map(v=>Object.keys(v)[0]).filter(v=>v!==x);return t.jsx($,{id:n,name:x,value:s[x],isOptions:D,options:e.headers,usedOptions:g,onChange:e.onChange,onDelete:e.onDelete},n)});return t.jsxs("div",{className:"head-body__box",children:[t.jsx("span",{className:"head-body__title",children:"Заголовки"}),t.jsxs("table",{children:[((r=e.data)==null?void 0:r.length)>0&&t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Заголовок"}),t.jsx("th",{children:"Значение"}),t.jsx("th",{})]})}),t.jsx("tbody",{children:i})]}),t.jsx("button",{onClick:s=>e.onAdd(s,D),children:"Добавить заголовок"})]})}const H=["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"],k=["GET","DELETE","HEAD","OPTIONS"],F=["POST","PUT","PATCH"],q=["Accept","Accept-Charset","Accept-Encoding","Accept-Language","Authorization","Cookie","Content-Disposition","Content-Encoding","Content-Language","Content-Length","Content-MD5","Content-Range","Content-Type","Content-Version","Derived-From","Expect","Form","Host","Link","Max-Forwards","Proxy-Authorization","Range","Referer","Title","TE"],V={method:"",url:"",query:[],body:"",headers:[]},b={method:{nullField:"Выберите метод запроса!",noValidMethod:"Выбранный метод не доступен!"},url:{nullField:"Введите URL запроса!",noValidUrl:"Некорректный формат URL!",noParamsAllowed:"URL не должен содержать параметры запроса"},query:{errTypeValue:'Ошибка значений параметров! Удалите все пары "ключ-значение" и пересоздайте снова.',nullField:'Есть незаполненные поля! Заполните или удалите незаполненные пары "ключ-значение".',duplicateKey:'Нельзя использовать несколько пар "ключ-значение" с одинаковыми ключами!'},body:{noContentType:"Content-Type не указан в заголовках!",invalidType:"Неподдерживаемый Content-Type!",noValidBody:"Тело запроса не соответствует Content-Type!",noCorrectBody:"Некорректный формат тела!"},headers:{errTypeValue:'Ошибка значений заголовков! Удалите все пары "заголовок-значение" и пересоздайте снова.',nullField:'Есть незаполненные поля! Заполните или удалите незаполненные пары "заголовок-значение".',noValidHeader:"Есть некорректные заголовки! Выберите заголовки из доступного списка.",duplicateKey:'Нельзя использовать несколько пар "заголовок-значение" с одинаковыми заголовками!'}},U={method:e=>e?H.includes(e.toUpperCase())?!1:b.method.noValidMethod:b.method.nullField,url:e=>{if(!e)return b.url.nullField;if(URL.canParse)return URL.canParse(e)?!1:b.url.noValidUrl;try{new URL(e)}catch{return b.url.noValidUrl}return!1},query:e=>{if(!(Array.isArray(e)&&e.every(o=>typeof o=="object"&&Object.keys(o).length===1)))return b.query.errTypeValue;const r=e.map(o=>Object.keys(o)[0]);return r.length!==new Set(r).size?b.query.duplicateKey:e.some(o=>Object.entries(o).some(([x,g])=>!x.trim()||!g.toString().trim()))?b.query.nullField:!1},body:(e,i)=>{if(!i)return b.body.noContentType;if(e==null)return b.body.noValidBody;try{if(i.includes("application/json")){const r=typeof e=="string"?JSON.parse(e):e;if(typeof r!="object"||r===null)return b.body.noCorrectBody}else if(i.includes("application/x-www-form-urlencoded")){const r=new URLSearchParams(e);if(Array.from(r.entries()).length===0&&e.trim()!=="")return b.body.noValidBody}else if(i.includes("text/plain")){if(typeof e!="string")return b.body.noValidBody}else return b.body.invalidType;return!1}catch{return b.body.noValidBody}},headers:e=>{if(!(Array.isArray(e)&&e.every(n=>typeof n=="object"&&Object.keys(n).length===1)))return b.headers.errTypeValue;const r=e.map(n=>Object.keys(n)[0]);if(r.length!==new Set(r).size)return b.headers.duplicateKey;for(const n of e){const[[o,x]]=Object.entries(n);if(!o.trim())return b.headers.nullField;if(!q.includes(o))return b.headers.noValidHeader;if(!x.toString().trim())return b.headers.nullField}return!1}};function Z(e){return!e||typeof e!="object"||Array.isArray(e)||Object.keys(e).length===0}function ee(e){var p;const[i,r]=y.useState(V),[s,n]=y.useState({}),o=((p=i.method)==null?void 0:p.toUpperCase())||"";y.useEffect(()=>{Z(e.dataReq)||(r(e.dataReq),n({}))},[e.dataReq]);const x=l=>{let a={},u=null;if(Array.isArray(l.headers)){const m=l.headers.find(d=>Object.keys(d).some(_=>_.toLowerCase()==="content-type"));if(m){const d=Object.keys(m).find(_=>_.toLowerCase()==="content-type");u=m[d]}}const h=typeof l.method=="string"?l.method.toUpperCase():"";for(let m in l)if(m==="body"){if(F.includes(h)){let d=U.body(l[m],u);d&&(a[m]=d)}}else{let d=U[m](l[m]);d&&(a[m]=d)}return n(a),!Object.keys(a).length},g=l=>{if(l.preventDefault(),e.resetDataRes(!0),x(i))return e.sendDataReq(i)},v=l=>{l.preventDefault(),r(V),n({}),e.resetDataRes(!0)},R=()=>{if(x(i))return e.saveDataReq(i)},O=l=>{const a=typeof l.target.value=="string"?l.target.value.toUpperCase():"";r(u=>{let h={...u};return h.method=a,k.includes(a)?"body"in h&&(h.body=""):"query"in h&&(h.query=[]),h}),e.resetDataRes(!0),n({})},C=l=>{const a=typeof l.target.value=="string"?l.target.value.trim():"";r(u=>u.url===a?u:{...u,url:a})},L=(l,a,u,h)=>{const m=h?"headers":"query",d=typeof u=="string"?u.trim():"";r(_=>{const c=JSON.parse(JSON.stringify(_[m])),N=JSON.parse(JSON.stringify(c[l])),S=Object.keys(N)[0];if(a==="name"){if(S===d)return _;const I=N[S];delete N[S],N[d]=I}else if(a==="value"){if(N[S]===d)return _;N[S]=d}return c[l]=N,{..._,[m]:c}})},w=(l,a,u)=>{l.preventDefault();const h=u?"headers":"query";r(m=>{const d=JSON.parse(JSON.stringify(m));return d[h]=d[h].filter((_,c)=>c!==a),d})},j=(l,a)=>{l.preventDefault();const u=a?"headers":"query";r(h=>({...h,[u]:[...Array.isArray(h[u])?h[u]:[],{"":""}]}))},f=l=>{const a=typeof l=="string"?l.trim():"";r(u=>u.body===a?u:{...u,body:a})},A=H.map((l,a)=>t.jsx("option",{value:l,children:l},a));return t.jsxs("form",{id:"formReq",onSubmit:g,onReset:v,className:"control-box__form",children:[t.jsxs("table",{className:"control-box__table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"control-box__table-method",children:t.jsx("label",{htmlFor:"method",children:"Метод"})}),t.jsx("th",{className:"control-box__table-url",children:t.jsx("label",{htmlFor:"url",children:"URL"})})]})}),t.jsx("tbody",{children:t.jsxs("tr",{children:[t.jsx("td",{children:t.jsxs("select",{id:"method",className:"table-method__input",value:o,onChange:O,children:[t.jsx("option",{value:"",disabled:!0,children:"Выберите метод:"},"100"),A]})}),t.jsx("td",{children:t.jsx("input",{type:"text",id:"url",className:"table-url__input",value:(i==null?void 0:i.url)||"",onChange:C})})]})})]}),t.jsx("div",{className:"control-box_text-err",children:s==null?void 0:s.method}),t.jsx("div",{className:"control-box_text-err",children:s==null?void 0:s.url}),t.jsx("hr",{}),k.includes(o)&&t.jsxs(y.Fragment,{children:[t.jsx(G,{data:i==null?void 0:i.query,onChange:L,onDelete:w,onAdd:j}),t.jsx("div",{className:"control-box_text-err",children:s==null?void 0:s.query})]}),F.includes(o)&&t.jsxs(y.Fragment,{children:[t.jsx(Q,{body:i==null?void 0:i.body,onChange:f}),t.jsx("div",{className:"control-box_text-err",children:s==null?void 0:s.body})]}),o&&t.jsx("hr",{}),o&&t.jsxs(y.Fragment,{children:[t.jsx(X,{data:i==null?void 0:i.headers,headers:q,onChange:L,onDelete:w,onAdd:j}),t.jsx("div",{className:"control-box_text-err",children:s==null?void 0:s.headers})]}),o&&t.jsx("hr",{}),t.jsxs("div",{className:"control-box__btn",children:[t.jsx("button",{type:"button",onClick:R,children:"Сохранить запрос"}),t.jsx("button",{type:"submit",children:"Отправить запрос"}),t.jsx("button",{type:"reset",children:"Сбросить форму"})]})]})}const te=y.memo(ee);function se(e,i){const r=document.createElement("a");r.href=e,r.download=i,r.click(),URL.revokeObjectURL(r.href)}function ne(e){var x,g,v,R,O,C,L,w;const[i,r]=y.useState(!1);if(e.isLoading)return t.jsxs("div",{className:"view-box__body",children:[t.jsx("h3",{className:"view-box__title",children:"Ответ на запрос"}),t.jsxs("div",{className:"animation__dot-pulse",children:[t.jsx("span",{}),t.jsx("span",{}),t.jsx("span",{})]})]});if(!e.dataRes||Object.keys(e.dataRes).length===0)return null;const s=()=>{const j=e.dataRes.headers["content-type"]||"";if(j.startsWith("application/json"))try{return t.jsx("pre",{className:"view-box__preview-json",children:JSON.stringify(e.dataRes.body,null,2)})}catch{return null}if(j.startsWith("text/html"))return t.jsx("iframe",{srcDoc:e.dataRes.body,title:"HTML Preview",sandbox:"allow-scripts",className:"view-box__preview-iframe"});if(j.startsWith("text/plain"))return t.jsx("pre",{className:"view-box__preview-text",children:e.dataRes.body});if(e.dataRes.body.match(/^[A-Za-z0-9+/=]+$/)){const f=j.split(";")[0];return t.jsxs("div",{className:"view-box__preview-binary",children:[t.jsxs("span",{className:"view-box__preview-bin-text",children:["Бинарные данные (",f,")"]}),f.startsWith("image/")?t.jsx("img",{src:`data:${f};base64,${e.dataRes.body}`,alt:"Preview",className:"view-box__preview-img"}):f.startsWith("audio/")?t.jsx("audio",{controls:!0,className:"view-box__preview-audio",children:t.jsx("source",{src:`data:${f};base64,${e.dataRes.body}`})}):f.startsWith("video/")?t.jsx("video",{controls:!0,className:"view-box__preview-video",children:t.jsx("source",{src:`data:${f};base64,${e.dataRes.body}`})}):t.jsxs("div",{className:"view-box__preview-other",children:[t.jsxs("div",{className:"view-box__preview-box-btn",children:[t.jsx("button",{onClick:()=>r(!i),className:"view-box__preview-btn",children:i?"Скрыть base64":"Показать base64"}),t.jsx("button",{onClick:()=>se(`data:${f};base64,${e.dataRes.body}`,"file.bin"),className:"view-box__preview-btn",children:"Скачать файл"})]}),i&&t.jsx("textarea",{readOnly:!0,value:e.dataRes.body,className:"view-box__preview-textarea"})]})]})}return null},n=(x=e.dataRes.redirects)==null?void 0:x.map((j,f)=>t.jsxs("div",{className:"view-box__redirect-pos",children:[t.jsx("span",{children:t.jsxs("b",{children:["Redirect №",f+1,":"]})}),t.jsxs("span",{children:[t.jsx("b",{children:"URL запроса:"})," ",j.startUrl]}),t.jsxs("span",{children:[t.jsx("b",{children:"Статус ответа:"})," ",j.status]}),t.jsxs("span",{children:[t.jsx("b",{children:"Location:"})," ",j.location]}),t.jsx("hr",{})]},f)),o=Object.keys((g=e.dataRes)==null?void 0:g.headers).map((j,f)=>t.jsxs("li",{children:[t.jsx("b",{children:j}),": ",e.dataRes.headers[j]]},f));return t.jsxs("div",{className:"view-box__body",children:[t.jsx("h3",{className:"view-box__title",children:"Ответ на запрос"}),((v=e.dataRes.redirects)==null?void 0:v.length)>0&&t.jsx("div",{className:"view-box__redirect-container",children:n}),t.jsxs("div",{className:"view-box__res-container",children:[t.jsxs("span",{children:[t.jsx("b",{children:"URL запроса:"})," ",(R=e.dataRes)==null?void 0:R.finalUrl]}),t.jsxs("span",{children:[t.jsx("b",{children:"Статус ответа:"})," ",(O=e.dataRes)==null?void 0:O.status]}),t.jsx("span",{children:t.jsx("b",{children:"Заголовки ответа:"})}),t.jsx("ul",{className:"view-box__list",children:o}),t.jsx("span",{children:t.jsx("b",{children:"Тело ответа:"})}),t.jsx("div",{className:"view-box__res-body",children:typeof((C=e.dataRes)==null?void 0:C.body)=="string"?(L=e.dataRes)==null?void 0:L.body:JSON.stringify((w=e.dataRes)==null?void 0:w.body)}),t.jsx("span",{children:t.jsx("b",{children:"Превью ответа:"})}),t.jsx("div",{className:"view-box__res-preview",children:s()})]})]})}const ie=y.memo(ne);function re(e){return t.jsxs("div",{className:"control-box",children:[t.jsx(te,{dataReq:e.dataReq,sendDataReq:e.sendDataReq,saveDataReq:e.saveDataReq,resetDataRes:e.resetDataRes}),t.jsx(ie,{dataRes:e.dataRes,isLoading:e.isLoading})]})}const oe=y.memo(re),ae="";function le(e){if(!e.ok)throw new Error(`${e.status} ${e.statusText}`)}const P=async(e,i={},r="")=>{try{const s=await fetch(`${ae}${e}`,{method:"POST",headers:{Accept:r,"Content-Type":r||"application/json"},body:JSON.stringify(i)});le(s);const n=s.headers.get("Content-Type")||"";return n.includes("application/json")?await s.json():n.startsWith("text/")?await s.text():n.includes("application/octet-stream")||n.includes("application/pdf")||n.includes("image/")||n.includes("audio/")||n.includes("video/")?await s.blob():await s.text()}catch(s){return alert(s),console.error(s),s}},T={getDataList:"/datalist",sendDataReq:"/send"};function B(e){var r;const i=s=>(s==null?void 0:s.map(n=>{const o=Object.entries(n);return o.sort(([x],[g])=>x.localeCompare(g)),JSON.stringify(o)}).sort().join("|"))||"";return{method:e.method.toLowerCase(),url:e.url.toLowerCase().trim(),body:((r=e.body)==null?void 0:r.trim())||"",query:i(e.query),headers:i(e.headers)}}function ce(e,i){const r=B(e);return i.some(s=>{const n=B(s);return n.method===r.method&&n.url===r.url&&n.body===r.body&&n.query===r.query&&n.headers===r.headers})}function E(e){alert(e),console.error(e)}function de(){const[e,i]=y.useState([]),[r,s]=y.useState(""),[n,o]=y.useState({}),[x,g]=y.useState({}),[v,R]=y.useState(!1),[O,C]=y.useState(!1),L=(a,u,h)=>{const m=window.localStorage.getItem("id"),d=m?{id:m}:{},_=h?{...d,add:h}:d;P(a,_).then(c=>{try{c!=null&&c.id&&window.localStorage.setItem("id",String(c==null?void 0:c.id)),c!=null&&c.error&&E(`Ошибка: ${c==null?void 0:c.error}`),Array.isArray(c==null?void 0:c.list)&&(c==null?void 0:c.list.length)>0&&u(c==null?void 0:c.list,c==null?void 0:c.html),R(!1)}catch(N){E(`Ошибка загрузки раздела "Избранное": ${N}`)}}).catch(c=>{E(`Ошибка загрузки раздела "Избранное": ${c}`)})},w=y.useCallback((a,u)=>{L(a,(m,d)=>{i(m),s(d)},u)},[]),j=(a,u,h)=>{P(a,h?{send:h}:{}).then(d=>{d!=null&&d.dataRes&&u(d.dataRes),C(!1)}).catch(d=>{E(`Ошибка запроса: ${d}`)})};y.useEffect(()=>(R(!0),w(T.getDataList,void 0),()=>{}),[w]);const f=a=>{let u=h=>{g(h)};j(T.sendDataReq,u,a),C(!0),o({...a})},A=a=>{a&&(g({}),o({}))},p=a=>{if(ce(a,e))return alert("Такой запрос уже есть в избранном!");w(T.getDataList,a)},l=a=>{g({}),o(e[a])};return t.jsxs("div",{className:"container",children:[t.jsx(z,{dataListHtml:r,openPosition:l,isLoading:v}),t.jsx(oe,{dataReq:n,dataRes:x,sendDataReq:f,saveDataReq:p,resetDataRes:A,isLoading:O})]})}M.createRoot(document.getElementById("root")).render(t.jsx(de,{}));
